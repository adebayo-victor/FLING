<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fling - Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --rich-black: #000F0B;
      --dark-green: #032221;
      --caribbean-green: #00F891;
      --anti-flash-white: #F1F7F9;
      --pistachio: #AACBC4;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--rich-black);
      color: var(--anti-flash-white);
    }

    .cool-gradient-background {
      background-image: linear-gradient(
        135deg,
        var(--rich-black) 0%,
        var(--dark-green) 50%,
        var(--rich-black) 100%
      );
    }

    .input-container {
      position: relative;
    }

    .fling-input,
    .fling-select {
      display: block;
      width: 100%;
      background-color: var(--dark-green);
      border: 2px solid var(--caribbean-green);
      border-radius: 0.5rem;
      color: var(--anti-flash-white);
      padding: 1rem 0.75rem 0.75rem;
      transition: all 0.2s ease;
    }

    .fling-select {
      appearance: none;
    }

    .fling-input:focus,
    .fling-select:focus {
      outline: none;
      box-shadow: 0 0 0 2px var(--caribbean-green);
    }

    .input-container label {
      position: absolute;
      top: -0.6rem;
      left: 0.75rem;
      background-color: var(--dark-green);
      padding: 0 0.5rem;
      color: var(--pistachio);
      font-size: 0.75rem;
      font-weight: 500;
      pointer-events: none;
    }

    .fling-btn {
      width: 100%;
      padding: 0.75rem;
      border-radius: 0.5rem;
      font-weight: 600;
      background-color: var(--caribbean-green);
      color: var(--rich-black);
      transition: all 0.2s ease;
    }

    .fling-btn:hover {
      background-color: #2CC299; /* softer mint green hover */
    }
  </style>
</head>
<body class="cool-gradient-background flex items-center justify-center min-h-screen p-4">
  <div class="w-full max-w-md bg-dark-green rounded-2xl shadow-2xl p-8 border-2 border-[var(--caribbean-green)]">
    
    <!-- Logo + Heading -->
    <div class="flex flex-col items-center mb-8">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none"
           xmlns="http://www.w3.org/2000/svg"
           class="text-caribbean-green mb-2">
        <path d="M21 12.0001L19.5 10.5001L15 15.0001L16.5 16.5001L21 12.0001Z" fill="currentColor"/>
        <path d="M12 3.0001L13.5 4.5001L9 9.0001L7.5 7.5001L12 3.0001Z" fill="currentColor"/>
        <path d="M3 12.0001L4.5 10.5001L9 15.0001L7.5 16.5001L3 12.0001Z" fill="currentColor"/>
        <path d="M12 21.0001L13.5 19.5001L9 15.0001L7.5 16.5001L12 21.0001Z" fill="currentColor"/>
      </svg>
      <h1 class="text-3xl font-bold text-anti-flash-white">Create Account</h1>
      <p class="text-sm text-caribbean-green mt-2">Sign up to host events and sell tickets.</p>
    </div>

    <!-- Form -->
    <form id="signup-form" class="space-y-6">
      <div class="input-container">
        <label for="name">Name</label>
        <input type="text" id="name" name="name" class="fling-input" required>
      </div>

      <div class="input-container">
        <label for="email">Email Address</label>
        <input type="email" id="email" name="email" class="fling-input" required>
      </div>

      <div class="input-container">
        <label for="phone">Whatsapp No.</label>
        <input type="tel" id="phone" name="phone" placeholder="+234 12345678" class="fling-input" required>
      </div>

      <div class="input-container">
        <label for="password">Password</label>
        <input type="password" id="password" name="password" class="fling-input" required>
      </div>

      <div class="input-container">
        <label for="bank">Bank</label>
        <select id="bank" name="bank" class="fling-select" required>
          <option value="">Select your bank</option>
        </select>
      </div>

      <div class="input-container">
        <label for="account_number">Account Number</label>
        <input type="text" id="account_number" name="account_number" maxlength="10" class="fling-input" required>
      </div>

      <button type="submit" class="fling-btn">Sign Up</button>
    </form>

    <!-- Alerts -->
    <h3 class="text-3xl font-bold text-anti-flash-white alert-text"></h3>

    <!-- Link -->
    <div class="mt-8 text-center text-sm text-[var(--pistachio)]">
      Already have an account? 
      <a href="https://fling-2a4m.onrender.com/register_login"
         class="text-caribbean-green hover:underline font-semibold">Log In</a>
    </div>
  </div>

  <script>
    // Populate bank dropdown
    async function loadBanks() {
      try {
        const res = await fetch("https://fling-2a4m.onrender.com/banks");
        const banks = await res.json();
        const select = document.getElementById("bank");

        banks.forEach(bank => {
          const opt = document.createElement("option");
          opt.value = bank.code;
          opt.textContent = bank.name;
          opt.classList.add("bg-[var(--dark-green)]", "text-[var(--anti-flash-white)]");
          select.appendChild(opt);
        });
      } catch (e) {
        console.error("Error loading banks:", e);
      }
    }
    loadBanks();

    // Handle signup form
    document.getElementById("signup-form").addEventListener("submit", async (e) => {
      e.preventDefault();

      const formData = new FormData(e.target);
      const payload = {
        name: formData.get("name"),
        phone: formData.get("phone"),
        email: formData.get("email"),
        password: formData.get("password"),
        bank_code: formData.get("bank"),
        account_number: formData.get("account_number")
      };

      document.querySelector('.alert-text').style.color = "yellow";
      document.querySelector('.alert-text').textContent = "Loading ...";

      try {
        const res = await fetch("/register", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        const result = await res.json();
        if (res.ok || res.message === "successful") {
          document.querySelector('.alert-text').style.color = "lightgreen";
          document.querySelector('.alert-text').textContent = "✅ Signup successful!, You may login";
        } else {
          document.querySelector('.alert-text').style.color = "red";
          document.querySelector('.alert-text').textContent = "❌Existing credentials, you may login";
        }
      } catch (err) {
        console.error("Network error:", err);
      }
    });
  </script>
</body>
</html>
